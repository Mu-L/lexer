# lexer

一个基于```DFA```法的支持多语言扩展的```JS```版开源词法分析器

## 目录

- [1、背景介绍](#1)
- [2、获取项目](#2)
- [3、使用方式](#3)
- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(1) 在项目中使用](#31)
- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[(2) 可视化预览与测试](#32)
- [3、参与贡献](#4)
- [4、协议说明](#5)

## <span id="1">1、背景介绍</span>

编译器前端中常用的词法分析方法包括```直接分析法```和```DFA（有限状态机）```两种，由于```直接分析法```不方便扩展，导致代码容易有各种```hack```，所以一般使用```DFA```实现词法分析器。

目前常见的词法分析器与语言耦合较为紧密且代码量较为庞大，难以关注词法分析器其本质原理，所以萌生了写一个完全与语言解耦且精简的词法分析器的想法，以把关注重心放在词法分析器的工作原理上，不再需要考虑由不同语言造成的细枝末节差异。

- ```lexer.js```文件是词法分析器的核心，主要分为```ISR```（输入流读取器）和```DFA```（有限状态自动机），与语言解耦，代码会保持在300行内
- ```lang/{lang}-define.js```文件是词法分析器的扩展，支持不同语言的接入，如```lang/c-define.js```文件，接入不同语言的方式见[贡献部分](#4)

## <span id="2">2、获取项目</span>

使用```git clone```获取本项目后，不需要任何依赖的安装，也不需多余的安装步骤

## <span id="3">3、使用方式</span>

### <span id="31">(1) 在项目中使用</span>

如果有在代码中使用```lexer```的需求（如Web版代码编辑器），需要依次引入以下文件

- ```/lang/{lang}-define.js```
- ```lexer.js```

然后直接访问```lexer```变量即可获取到词法分析器对象，其中```tokens```数据可以通过访问```lexer.DFA.result.tokens```获取

```js
// 1. 需要词法解析的代码
let stream = "int a = 10;";

// 2. 开始词法分析
lexer.start(strem);

// 3. 词法分析结束后, 获取生成的tokens
let parsedTokens = lexer.DFA.result.tokens;

// 4. 做你想做的
parsedTokens.forEach((token) => {
    // ... ...
});
```

### <span id="32">(2) 可视化预览与测试功能</span>

为了实时查看Lexer工作效果，也方便对Lexer进行测试，在项目根目录下有一个```index.html```文件，它提供了Lexer的可视化预览与测试功能，在浏览器中打开即可使用，如下图所演示

> Lexer的单元测试会在页面打开前自动完成，如果测试失败会有错误提示和弹窗的强制通知，打开浏览器控制台即可查看单元测试的具体情况

![img](/doc/image/show.gif)

## <span id="4">参与贡献</span>

- 提供更多语言的 ```/lang/{lang}-define.js```
- 源码解析请见[文档](/doc/explain.md)

## <span id="5">协议说明</span>

[MIT](/LICENSE)
